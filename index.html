<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Terra Rossa Spoon Juggle</title>
<style>
  body {
    font-family: sans-serif;
    text-align: center;
    background-color: #fdf6e3;
    overflow-x: hidden;
    margin: 0;
    padding: 0;
  }

  h1 {
    margin-top: 20px;
  }

  #character-container {
    position: relative;
    width: 90%;
    max-width: 560px;
    height: auto;
    margin: 20px auto 0 auto;
  }

  #character {
    width: 100%;
    height: auto;
    display: block;
  }

  .spoon {
    position: absolute;
    width: 50px;
    height: 50px;
    transform-origin: 50% 50%;
  }

  .pots {
    display: flex;
    justify-content: center;
    margin: 20px auto;
    gap: 20px;
    flex-wrap: wrap;
    max-width: 560px;
  }

  .pot {
    width: 120px;
    height: 120px;
    position: relative;
  }

  .pot img {
    width: 100%;
    height: auto;
  }

  .spoons-in-pot {
    position: absolute;
    bottom: 10px;
    left: 10px;
    display: flex;
    gap: 5px;
  }

  /* Hidden target for spoon landing */
  .target {
    position: absolute;
    width: 1px;
    height: 1px;
    bottom: 10px;
    left: 10px;
  }

  #controls {
    margin-top: 20px;
  }

  #drawButton, #resetButton {
    padding: 10px 20px;
    font-size: 18px;
    margin: 0 10px;
  }

  @media (max-width: 500px) {
    .spoon { width: 12vw; max-width: 40px; }
    .pot { width: 45%; max-width: 100px; }
    #drawButton, #resetButton { font-size: 16px; padding: 8px 16px; }
    h1 { font-size: 18px; }
  }
</style>
</head>
<body>

<h1>Terra Rossa Spoon Juggle</h1>

<div id="character-container">
  <img id="character" src="uploaded_cartoon2.png" alt="Character">
</div>

<div class="pots">
  <div class="pot" id="A">
    <img src="pot_A.png" alt="Pot A">
    <div class="spoons-in-pot" id="potA"></div>
    <div class="target" id="targetA"></div>
  </div>
  <div class="pot" id="B">
    <img src="pot_B.png" alt="Pot B">
    <div class="spoons-in-pot" id="potB"></div>
    <div class="target" id="targetB"></div>
  </div>
  <div class="pot" id="C">
    <img src="pot_C.png" alt="Pot C">
    <div class="spoons-in-pot" id="potC"></div>
    <div class="target" id="targetC"></div>
  </div>
  <div class="pot" id="D">
    <img src="pot_D.png" alt="Pot D">
    <div class="spoons-in-pot" id="potD"></div>
    <div class="target" id="targetD"></div>
  </div>
</div>

<div id="controls">
  <button id="drawButton">Draw a Spoon</button>
  <button id="resetButton">Reset</button>
</div>

<script>
const container = document.getElementById('character-container');
const potsWrapper = document.querySelector('.pots');
const totalSpoons = 16;
const radius = 100;
let angleOffset = 0;
let spoons = [];

const potCounts = { A:0, B:0, C:0, D:0 };
const potMax = 4;

const potElements = {
  A: document.getElementById('potA'),
  B: document.getElementById('potB'),
  C: document.getElementById('potC'),
  D: document.getElementById('potD')
};

function createSpoons(){
  spoons=[];
  for(let i=1;i<=totalSpoons;i++){
    const spoonEl=document.createElement('img');
    spoonEl.src=`spoon_${i}.png`;
    spoonEl.className='spoon';
    spoonEl.style.position='absolute';
    container.appendChild(spoonEl);

    spoons.push({
      el:spoonEl,
      number:i,
      angle:(i/totalSpoons)*2*Math.PI,
      flying:false
    });
  }
}
createSpoons();

function animate(){
  angleOffset+=0.02;

  const centerX = container.offsetWidth/2;
  const centerY = container.offsetHeight/2 - 50;

  spoons.forEach(spoon=>{
    if(spoon.flying) return;

    const baseX=centerX + radius*Math.cos(spoon.angle+angleOffset);
    const baseY=centerY + radius*Math.sin(spoon.angle+angleOffset);

    const jitterX = Math.sin(angleOffset*3 + spoon.number)*10;
    const jitterY = Math.cos(angleOffset*2 + spoon.number)*8;
    const rotation = angleOffset*180 + spoon.number*20;

    spoon.el.style.left = (baseX + jitterX - 25) + 'px';
    spoon.el.style.top = (baseY + jitterY - 25) + 'px';
    spoon.el.style.transform = `rotate(${rotation}deg)`;
  });

  requestAnimationFrame(animate);
}
animate();

function getRandomPot(){
  const available = Object.keys(potCounts).filter(p=>potCounts[p]<potMax);
  if(!available.length) return null;
  const choice = available[Math.floor(Math.random()*available.length)];
  potCounts[choice]++;
  return choice;
}

function flyToPot(spoon, potKey){

  spoon.flying = true;

  const potContainer = potElements[potKey];

  // Get destination relative to page
  const potRect = potContainer.getBoundingClientRect();
  const pageX = potRect.left + window.scrollX;
  const pageY = potRect.top + window.scrollY;

  const offsetIndex = potContainer.children.length;

  const destX = pageX + offsetIndex*45 + 20;
  const destY = pageY + 20;

  const startRect = spoon.el.getBoundingClientRect();
  const startX = startRect.left + window.scrollX;
  const startY = startRect.top + window.scrollY;

  spoon.el.style.position='absolute';
  spoon.el.style.zIndex=1000;
  document.body.appendChild(spoon.el);

  const midX = (startX+destX)/2;
  const midY = (startY+destY)/2 - 120;

  const finalRotation = (Math.random()*20 - 10);

  let t=0;
  const duration=60;

  function animateArc(){
    t++;
    const progress=t/duration;

    const x = (1-progress)*(1-progress)*startX
            + 2*(1-progress)*progress*midX
            + progress*progress*destX;

    const y = (1-progress)*(1-progress)*startY
            + 2*(1-progress)*progress*midY
            + progress*progress*destY;

    spoon.el.style.left = x + 'px';
    spoon.el.style.top = y + 'px';
    spoon.el.style.transform = `rotate(${finalRotation*progress}deg)`;

    if(t<duration){
      requestAnimationFrame(animateArc);
    }else{
      spoon.el.style.position='relative';
      spoon.el.style.left='0px';
      spoon.el.style.top='0px';
      spoon.el.style.transform=`rotate(${finalRotation}deg)`;
      potContainer.appendChild(spoon.el);
    }
  }

  animateArc();
}

document.getElementById('drawButton').addEventListener('click', ()=>{
  if(!spoons.length) return;

  const index=Math.floor(Math.random()*spoons.length);
  const spoon=spoons.splice(index,1)[0];

  const potKey=getRandomPot();
  if(potKey) flyToPot(spoon,potKey);
});

document.getElementById('resetButton').addEventListener('click', ()=>{

  Object.values(potElements).forEach(p=>{
    while(p.firstChild) p.removeChild(p.firstChild);
  });

  for(let key in potCounts) potCounts[key]=0;

  spoons.forEach(spoon=>{
    if(spoon.el.parentElement) spoon.el.remove();
  });

  createSpoons();
});
</script>


</body>
</html>


