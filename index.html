<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Terra Rossa Spoon Juggle</title>

<style>
body{
  font-family:sans-serif;
  text-align:center;
  background:#fdf6e3;
  margin:0;
  padding:0;
  overflow-x:hidden;
}

h1{ margin-top:20px; }

#game-area{
  position:relative;
  max-width:560px;
  margin:0 auto;
}

#character-container{
  position:relative;
  width:100%;
}

#character{
  width:100%;
  display:block;
}

.spoon{
  position:absolute;
  width:50px;
  height:50px;
  transform-origin:50% 50%;
}

.pots{
  display:flex;
  justify-content:center;
  gap:20px;
  margin:20px 0;
  flex-wrap:wrap;
}

.pot{
  width:120px;
  position:relative;
}

.pot img{
  width:100%;
  display:block;
}

#controls{
  margin:20px 0;
}

button{
  padding:10px 20px;
  font-size:18px;
  margin:0 10px;
}

/* Mobile */
@media(max-width:500px){
  .spoon{ width:40px;height:40px; }
  .pot{ width:45%; max-width:100px; }
}
</style>
</head>

<body>

<h1>Terra Rossa Spoon Juggle</h1>

<div id="game-area">

  <div id="character-container">
    <img id="character" src="uploaded_cartoon2.png">
  </div>

  <div class="pots">
    <div class="pot" id="A"><img src="pot_A.png"></div>
    <div class="pot" id="B"><img src="pot_B.png"></div>
    <div class="pot" id="C"><img src="pot_C.png"></div>
    <div class="pot" id="D"><img src="pot_D.png"></div>
  </div>

</div>

<div id="controls">
  <button id="drawButton">Draw a Spoon</button>
  <button id="resetButton">Reset</button>
</div>

<script>

const gameArea = document.getElementById('game-area');
const container = document.getElementById('character-container');

const totalSpoons = 16;
const radius = 100;
let angleOffset = 0;
let spoons = [];

const potCounts = {A:0,B:0,C:0,D:0};
const potMax = 4;

// Create spoons
function createSpoons(){
  spoons=[];
  for(let i=1;i<=totalSpoons;i++){
    const el=document.createElement('img');
    el.src=`spoon_${i}.png`;
    el.className='spoon';
    gameArea.appendChild(el);

    spoons.push({
      el:el,
      number:i,
      angle:(i/totalSpoons)*2*Math.PI,
      flying:false
    });
  }
}
createSpoons();

// Animate spinning
function animate(){
  angleOffset+=0.02;

  const centerX = container.offsetWidth/2;
  const centerY = container.offsetHeight/2 - 50;

  spoons.forEach(spoon=>{
    if(spoon.flying) return;

    const x=centerX + radius*Math.cos(spoon.angle+angleOffset);
    const y=centerY + radius*Math.sin(spoon.angle+angleOffset);

    const jitterX=Math.sin(angleOffset*3+spoon.number)*10;
    const jitterY=Math.cos(angleOffset*2+spoon.number)*8;

    spoon.el.style.left=(x+jitterX-25)+'px';
    spoon.el.style.top=(y+jitterY-25)+'px';
    spoon.el.style.transform=`rotate(${angleOffset*180}deg)`;
  });

  requestAnimationFrame(animate);
}
animate();

// Get random pot
function getRandomPot(){
  const available=Object.keys(potCounts).filter(p=>potCounts[p]<potMax);
  if(!available.length) return null;
  const choice=available[Math.floor(Math.random()*available.length)];
  potCounts[choice]++;
  return choice;
}

// Animate spoon flying into pot with bounce and upright position
function flyToPot(spoon,potKey){

  spoon.flying=true;

  const pot=document.getElementById(potKey);
  const potRect=pot.getBoundingClientRect();
  const areaRect=gameArea.getBoundingClientRect();

  const spoonSize=spoon.el.offsetWidth;
  const startRect=spoon.el.getBoundingClientRect();

  const startX=startRect.left-areaRect.left+spoonSize/2;
  const startY=startRect.top-areaRect.top+spoonSize/2;

  const destX=potRect.left-areaRect.left+potRect.width/2;
  const destY=potRect.top-areaRect.top+potRect.height-50; // slightly higher so it sits upright

  const midX=(startX+destX)/2;
  const midY=(startY+destY)/2-120;

  let t=0;
  const duration=60;

  function animateArc(){
    t++;
    const p=t/duration;

    const x=(1-p)*(1-p)*startX + 2*(1-p)*p*midX + p*p*destX;
    const y=(1-p)*(1-p)*startY + 2*(1-p)*p*midY + p*p*destY;

    spoon.el.style.left=(x-spoonSize/2)+'px';
    spoon.el.style.top=(y-spoonSize/2)+'px';

    if(t<duration){
      requestAnimationFrame(animateArc);
    } else {
      const index = potCounts[potKey]-1;
      const fanRotation = -5 + (index*5); // slight fanned angle so spoons are upright but not fully overlapping

      // Smooth landing with tiny bounce
      spoon.el.style.transition = 'transform 0.3s ease, top 0.3s ease';
      spoon.el.style.transform = `rotate(${fanRotation}deg)`;
      spoon.el.style.top = (destY-spoonSize/2 - 10) + 'px';

      setTimeout(()=>{
        spoon.el.style.top = (destY-spoonSize/2) + 'px';
      }, 150);
    }
  }

  animateArc();
}

// Draw a spoon
document.getElementById('drawButton').addEventListener('click',()=>{
  if(!spoons.length) return;
  const index=Math.floor(Math.random()*spoons.length);
  const spoon=spoons.splice(index,1)[0];
  const potKey=getRandomPot();
  if(potKey) flyToPot(spoon,potKey);
});

// Reset button
document.getElementById('resetButton').addEventListener('click',()=>{
  spoons.forEach(s=>s.el.remove());
  for(let k in potCounts) potCounts[k]=0;
  createSpoons();
});

</script>

</body>
</html>
